# Kentucky TANF (K-TAP) Countable Earned Income
# Per 921 KAR 2:016 Section 5(3)(a) and Section 8
# Work Expense Deduction: $175/month (both full-time and part-time)
# 50% Earned Income Disregard: Applied to remainder (ongoing cases, 6 months)
# Formula: max(sum_of_gross_earned - 175, 0) * 0.5

- name: Case 1, no earned income results in zero countable.
  period: 2024-01
  input:
    people:
      person1:
        tanf_gross_earned_income: 0
    households:
      household:
        members: [person1]
        state_code: KY
  output:
    # No income, no deductions needed
    ky_ktap_countable_earned_income: 0

- name: Case 2, income below work expense deduction.
  period: 2024-01
  input:
    people:
      person1:
        tanf_gross_earned_income: 100
    households:
      household:
        members: [person1]
        state_code: KY
  output:
    # $100 gross - $175 work expense = $0 (cannot be negative)
    ky_ktap_countable_earned_income: 0

- name: Case 3, income exactly at work expense deduction.
  period: 2024-01
  input:
    people:
      person1:
        tanf_gross_earned_income: 175
    households:
      household:
        members: [person1]
        state_code: KY
  output:
    # $175 gross - $175 work expense = $0
    ky_ktap_countable_earned_income: 0

- name: Case 4, moderate earned income with deduction.
  period: 2024-01
  input:
    people:
      person1:
        tanf_gross_earned_income: 500
    households:
      household:
        members: [person1]
        state_code: KY
  output:
    # $500 gross - $175 work expense = $325
    # $325 * 0.5 (50% disregard) = $162.50
    ky_ktap_countable_earned_income: 162.5

- name: Case 5, higher earned income with deduction.
  period: 2024-01
  input:
    people:
      person1:
        tanf_gross_earned_income: 1_000
    households:
      household:
        members: [person1]
        state_code: KY
  output:
    # $1,000 gross - $175 work expense = $825
    # $825 * 0.5 (50% disregard) = $412.50
    ky_ktap_countable_earned_income: 412.5

- name: Case 6, two earners in household.
  period: 2024-01
  input:
    people:
      person1:
        tanf_gross_earned_income: 600
      person2:
        tanf_gross_earned_income: 400
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: KY
  output:
    # Per-person deductions per MS 2840:
    # Person1: max($600 - $175, 0) = $425, 50%: $212.50
    # Person2: max($400 - $175, 0) = $225, 50%: $112.50
    # Unit total: $325
    ky_ktap_countable_earned_income: 325

- name: Case 8, two earners with dependent care.
  period: 2024-01
  absolute_error_margin: 0.1
  input:
    people:
      person1:
        age: 30
        tanf_gross_earned_income: 600
      person2:
        age: 28
        tanf_gross_earned_income: 400
      person3:
        age: 5
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
        # $300/month * 12 = $3,600/year
        childcare_expenses: 3_600
    households:
      household:
        members: [person1, person2, person3]
        state_code: KY
  output:
    # Dependent care: min($300, $175 cap for age 5) = $175
    # Allocated to Person1 (highest earner) per MS 2840 B.2.c
    # Person1: max($600 - $175, 0) = $425, dep care $175 â†’ $250, 50%: $125
    # Person2: max($400 - $175, 0) = $225, no dep care, 50%: $112.50
    # Unit total: $237.50
    ky_ktap_countable_earned_income: 237.5

- name: Case 7, non-KY state returns zero.
  period: 2024-01
  input:
    people:
      person1:
        tanf_gross_earned_income: 500
    households:
      household:
        members: [person1]
        state_code: TX
  output:
    # Not in Kentucky
    ky_ktap_countable_earned_income: 0

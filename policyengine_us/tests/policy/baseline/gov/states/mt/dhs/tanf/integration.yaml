- name: Case 1, single parent of one with no earnings gets maximum benefit.
  period: 2024-01
  absolute_error_margin: 0.1
  input:
    people:
      person1: {}
      person2:
        age: 10
    spm_units:
      spm_unit:
        members: [person1, person2]
        mt_tanf_meets_work_requirements: true
    households:
      household:
        members: [person1, person2]
        state_code: MT
  output:
    mt_tanf_assistance_unit_size: 2
    # 2023 FPL size 2: (14_580 + 5_140) / 12 = 1_643.33
    mt_tanf_assistance_unit_fpg: 1_643.33
    # Payment standard = 1_643.33 * 0.35 = 575.17
    mt_tanf_payment_standard: 575.17
    mt_tanf_gross_earned_income: 0
    mt_tanf_countable_earned_income: 0
    mt_tanf_countable_income: 0
    # Benefit standard = 1_643.33 * 0.30 = 493.00
    mt_tanf_benefit_standard: 493.00
    # Net income standard = 493.00 / 0.785 = 628.03
    mt_tanf_net_income_standard: 628.03
    # Gross income standard = 628.03 * 1.85 = 1_161.85
    mt_tanf_gross_income_standard: 1_161.85
    mt_tanf_gross_income: 0
    mt_tanf_payment_standard_eligible: true
    mt_tanf_benefit_standard_eligible: true
    mt_tanf_gmi_eligible: true
    mt_tanf_income_eligible: true
    mt_tanf_resources_eligible: true
    mt_tanf_meets_work_requirements: true
    mt_tanf_eligible: true
    # Final TANF = max(575.17 - 0, 0) = 575.17
    mt_tanf: 575.17

- name: Case 2, single parent of one with eligible earnings gets difference between standard payment and countable income.
  period: 2024-01
  absolute_error_margin: 0.1
  input:
    people:
      person1:
        age: 40
        employment_income_before_lsr: 9_000
        weekly_hours_worked: 35
        is_tax_unit_head_or_spouse: true
        immigration_status: CITIZEN
      person2:
        age: 10
        is_tax_unit_dependent: true
    spm_units:
      spm_unit:
        childcare_expenses: 2_400
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: MT
  output:
    mt_tanf_assistance_unit_size: 2
    # 2023 FPL size 2: (14_580 + 5_140) / 12 = 1_643.33
    mt_tanf_assistance_unit_fpg: 1_643.33
    mt_tanf_payment_standard: 575.17
    mt_tanf_gross_earned_income: 750.00
    # Countable earned income = gross income - $200 work expense - 25% disregard
    # = 750 - 200 - ((750 - 200) * 0.25) = 412.50
    mt_tanf_countable_earned_income: 750 - 200 - ((750 - 200) * 0.25)
    # Countable income = countable earned income - $200 dependent care expenses
    # 412.50 - 200 = 212.50
    mt_tanf_countable_income: 412.50 - 200
    # Benefit standard = 1_643.33 * 0.30 = 493.00
    mt_tanf_benefit_standard: 493.00
    # Net income standard = 493.00 / 0.785 = 628.03
    mt_tanf_net_income_standard: 628.03
    # Gross income standard = 628.03 * 1.85 = 1_161.85
    mt_tanf_gross_income_standard: 1_161.85
    mt_tanf_gross_income: 750.00
    mt_tanf_payment_standard_eligible: true
    mt_tanf_benefit_standard_eligible: true
    mt_tanf_gmi_eligible: true
    mt_tanf_income_eligible: true
    mt_tanf_resources_eligible: true
    mt_tanf_meets_work_requirements: true
    mt_tanf_eligible: true
    # Final TANF = max(575.17 - 212.50, 0) = 362.67
    mt_tanf: 575.17 - 212.50

- name: Case 3, household ineligible due to missing work requirement.
  period: 2024-01
  absolute_error_margin: 0.1
  input:
    people:
      person1:
        age: 40
        employment_income_before_lsr: 12_000
        weekly_hours_worked: 10
        is_tax_unit_head_or_spouse: true
        immigration_status: CITIZEN
      person2:
        age: 10
        is_tax_unit_dependent: true
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: MT
  output:
    mt_tanf_assistance_unit_size: 2
    # 2023 FPL size 2: (14_580 + 5_140) / 12 = 1_643.33
    mt_tanf_assistance_unit_fpg: 1_643.33
    mt_tanf_payment_standard: 575.17
    mt_tanf_gross_earned_income: 1_000.00
    # Countable earned income = gross income - $200 work expense - 25% disregard
    # = 1_000 - 200 - ((1_000 - 200) * 0.25) = 600.00
    mt_tanf_countable_earned_income: 1_000 - 200 - ((1_000 - 200) * 0.25)
    mt_tanf_countable_income: 600.00
    # Benefit standard = 1_643.33 * 0.30 = 493.00
    mt_tanf_benefit_standard: 493.00
    # Net income standard = 493.00 / 0.785 = 628.03
    mt_tanf_net_income_standard: 628.03
    # Gross income standard = 628.03 * 1.85 = 1_161.85
    mt_tanf_gross_income_standard: 1_161.85
    mt_tanf_gross_income: 1_000.00
    mt_tanf_payment_standard_eligible: false
    mt_tanf_benefit_standard_eligible: false
    mt_tanf_gmi_eligible: true
    mt_tanf_income_eligible: false
    mt_tanf_resources_eligible: true
    mt_tanf_meets_work_requirements: false
    mt_tanf_eligible: false
    # Final TANF = 0 (ineligible due to work requirement)
    mt_tanf: 0

- name: Case 4, two-parent household with eligible earnings gets difference between standard payment and countable income.
  period: 2024-01
  absolute_error_margin: 0.1
  input:
    people:
      person1:
        age: 40
        employment_income_before_lsr: 4_500
        weekly_hours_worked: 35
        is_tax_unit_head_or_spouse: true
        immigration_status: CITIZEN
      person2:
        age: 40
        employment_income_before_lsr: 4_500
        weekly_hours_worked: 35
        is_tax_unit_head_or_spouse: true
        immigration_status: CITIZEN
      person3:
        age: 10
        is_tax_unit_dependent: true
      person4:
        age: 5
        is_tax_unit_dependent: true
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4]
    households:
      household:
        members: [person1, person2, person3, person4]
        state_code: MT
  output:
    mt_tanf_assistance_unit_size: 4
    # 2023 FPL size 4: (14_580 + 3 * 5_140) / 12 = 2_500.00
    mt_tanf_assistance_unit_fpg: 2_500.00
    # Payment standard = 2_500.00 * 0.35 = 875.00
    mt_tanf_payment_standard: 875.00
    mt_tanf_gross_earned_income: 750.00
    # Earned income after disregard (each parent) = 375 - 200 - ((375 - 200) * 0.25) = 131.25
    mt_tanf_earned_income_after_disregard_person: [131.25, 131.25, 0, 0]
    # Countable SPM Unit earned income = 131.25 * 2 = 262.50
    mt_tanf_countable_earned_income: 131.25 * 2
    mt_tanf_countable_income: 262.50
    # Benefit standard = 2_500.00 * 0.30 = 750.00
    mt_tanf_benefit_standard: 750.00
    # Net income standard = 750.00 / 0.785 = 955.41
    mt_tanf_net_income_standard: 955.41
    # Gross income standard = 955.41 * 1.85 = 1_767.52
    mt_tanf_gross_income_standard: 1_767.52
    mt_tanf_gross_income: 750.00
    mt_tanf_payment_standard_eligible: true
    mt_tanf_benefit_standard_eligible: true
    mt_tanf_gmi_eligible: true
    mt_tanf_income_eligible: true
    mt_tanf_resources_eligible: true
    mt_tanf_meets_work_requirements: true
    mt_tanf_eligible: true
    # Final TANF = max(875.00 - 262.50, 0) = 612.50
    mt_tanf: 875.00 - 262.50

- name: Case 5, two-parent household ineligible due to high income.
  period: 2024-01
  absolute_error_margin: 0.1
  input:
    people:
      person1:
        age: 40
        employment_income_before_lsr: 12_480
        weekly_hours_worked: 35
        is_tax_unit_head_or_spouse: true
        immigration_status: CITIZEN
      person2:
        age: 40
        employment_income_before_lsr: 4_500
        weekly_hours_worked: 35
        is_tax_unit_head_or_spouse: true
        immigration_status: CITIZEN
      person3:
        age: 10
        is_tax_unit_dependent: true
      person4:
        age: 5
        is_tax_unit_dependent: true
    spm_units:
      spm_unit:
        members: [person1, person2, person3, person4]
    households:
      household:
        members: [person1, person2, person3, person4]
        state_code: MT
  output:
    mt_tanf_assistance_unit_size: 4
    # 2023 FPL size 4: (14_580 + 3 * 5_140) / 12 = 2_500.00
    mt_tanf_assistance_unit_fpg: 2_500.00
    # Payment standard = 2_500.00 * 0.35 = 875.00
    mt_tanf_payment_standard: 875.00
    mt_tanf_gross_earned_income: 1_415.00
    # Person 1: 1_040 - 200 - ((1_040 - 200) * 0.25) = 630.00
    # Person 2: 375 - 200 - ((375 - 200) * 0.25) = 131.25
    mt_tanf_earned_income_after_disregard_person: [630.00, 131.25, 0, 0]
    # Countable SPM Unit earned income = 630.00 + 131.25 = 761.25
    mt_tanf_countable_earned_income: 761.25
    mt_tanf_countable_income: 761.25
    # Benefit standard = 2_500.00 * 0.30 = 750.00
    mt_tanf_benefit_standard: 750.00
    # Net income standard = 750.00 / 0.785 = 955.41
    mt_tanf_net_income_standard: 955.41
    # Gross income standard = 955.41 * 1.85 = 1_767.52
    mt_tanf_gross_income_standard: 1_767.52
    mt_tanf_gross_income: 1_415.00
    mt_tanf_payment_standard_eligible: true
    mt_tanf_benefit_standard_eligible: false
    mt_tanf_gmi_eligible: true
    mt_tanf_income_eligible: false
    mt_tanf_resources_eligible: true
    mt_tanf_meets_work_requirements: true
    mt_tanf_eligible: false
    # Final TANF = 0 (income exceeds benefit standard)
    mt_tanf: 0

- name: Case 6, single parent with mixed earned and unearned income.
  period: 2024-01
  absolute_error_margin: 0.1
  input:
    people:
      person1:
        age: 40
        employment_income_before_lsr: 6_000
        social_security: 2_400
        weekly_hours_worked: 35
        is_tax_unit_head_or_spouse: true
        immigration_status: CITIZEN
      person2:
        age: 10
        is_tax_unit_dependent: true
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: MT
  output:
    mt_tanf_assistance_unit_size: 2
    # 2023 FPL size 2: (14_580 + 5_140) / 12 = 1_643.33
    mt_tanf_assistance_unit_fpg: 1_643.33
    mt_tanf_payment_standard: 575.17
    mt_tanf_gross_earned_income: 500.00
    mt_tanf_gross_unearned_income: 200.00
    mt_tanf_gross_income: 700.00
    # Earned after disregard = (500 - 200) * 0.75 = 225
    mt_tanf_countable_earned_income: (500 - 200) * 0.75
    # Countable income = 225 + 200 (unearned) = 425
    mt_tanf_countable_income: 225 + 200
    mt_tanf_gmi_eligible: true
    mt_tanf_benefit_standard_eligible: true
    mt_tanf_payment_standard_eligible: true
    mt_tanf_income_eligible: true
    mt_tanf_meets_work_requirements: true
    mt_tanf_eligible: true
    # Final TANF = max(575.17 - 425, 0) = 150.17
    mt_tanf: 575.17 - 425

- name: Case 7, household with SSI recipient excluded from assistance unit.
  period: 2024-01
  absolute_error_margin: 0.1
  input:
    people:
      person1:
        age: 40
        weekly_hours_worked: 35
        is_tax_unit_head_or_spouse: true
        immigration_status: CITIZEN
      person2:
        age: 10
        is_tax_unit_dependent: true
      person3:
        age: 8
        is_tax_unit_dependent: true
        ssi: 800
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: MT
  output:
    # SSI child excluded from AU, so AU = person1 + person2 = 2
    mt_tanf_assistance_unit_size: 2
    mt_tanf_assistance_unit_fpg: 1_643.33
    mt_tanf_payment_standard: 575.17
    mt_tanf_countable_income: 0
    mt_tanf_gmi_eligible: true
    mt_tanf_income_eligible: true
    mt_tanf_meets_work_requirements: true
    mt_tanf_eligible: true
    # Max benefit for AU=2
    mt_tanf: 575.17

- name: Case 8, household ineligible due to GMI test failure.
  period: 2024-01
  absolute_error_margin: 0.1
  input:
    people:
      person1:
        age: 40
        employment_income_before_lsr: 18_000
        weekly_hours_worked: 35
        is_tax_unit_head_or_spouse: true
        immigration_status: CITIZEN
      person2:
        age: 10
        is_tax_unit_dependent: true
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: MT
  output:
    mt_tanf_assistance_unit_size: 2
    mt_tanf_assistance_unit_fpg: 1_643.33
    mt_tanf_gross_earned_income: 1_500.00
    mt_tanf_gross_income: 1_500.00
    # GMI standard = 493.00 / 0.785 * 1.85 = 1_161.85
    # Gross income 1_500 > 1_161.85 = FAIL
    mt_tanf_gmi_eligible: false
    mt_tanf_income_eligible: false
    mt_tanf_eligible: false
    mt_tanf: 0

- name: Case 9, pregnant woman alone with small income gets benefit.
  period: 2024-01
  absolute_error_margin: 0.1
  input:
    people:
      person1:
        age: 25
        is_pregnant: true
        employment_income_before_lsr: 3_600
        weekly_hours_worked: 35
        is_tax_unit_head_or_spouse: true
        immigration_status: CITIZEN
        ssi: 0
    spm_units:
      spm_unit:
        members: [person1]
    households:
      household:
        members: [person1]
        state_code: MT
  output:
    # AU = 1 (just the pregnant person)
    mt_tanf_assistance_unit_size: 1
    # 2023 FPL size 1: 14_580 / 12 = 1_215.00
    mt_tanf_assistance_unit_fpg: 1_215.00
    # Payment standard = 1_215.00 * 0.35 = 425.25
    mt_tanf_payment_standard: 425.25
    mt_tanf_gross_earned_income: 300.00
    # Earned after disregard = (300 - 200) * 0.75 = 75
    mt_tanf_countable_earned_income: (300 - 200) * 0.75
    mt_tanf_countable_income: 75.00
    mt_tanf_gmi_eligible: true
    mt_tanf_income_eligible: true
    mt_tanf_meets_work_requirements: true
    mt_tanf_eligible: true
    # Final TANF = max(425.25 - 75, 0) = 350.25
    mt_tanf: 425.25 - 75

- name: Case 10, FPL pinning stability - 2025 produces same standards as 2024.
  period: 2025-01
  absolute_error_margin: 0.1
  input:
    people:
      person1:
        age: 40
        weekly_hours_worked: 35
        is_tax_unit_head_or_spouse: true
        immigration_status: CITIZEN
      person2:
        age: 10
        is_tax_unit_dependent: true
      person3:
        age: 8
        is_tax_unit_dependent: true
    spm_units:
      spm_unit:
        members: [person1, person2, person3]
    households:
      household:
        members: [person1, person2, person3]
        state_code: MT
  output:
    mt_tanf_assistance_unit_size: 3
    # FPL pinned to 2023: (14_580 + 2 * 5_140) / 12 = 2_071.67
    # Same as 2024 despite being in 2025 because of FPL year pinning
    # Payment standard = 2_071.67 * 0.35 = 725.08
    mt_tanf_payment_standard: 725.08
    # Benefit standard = 2_071.67 * 0.30 = 621.50
    mt_tanf_benefit_standard: 621.50
    # Net income standard = 621.50 / 0.785 = 791.72
    mt_tanf_net_income_standard: 791.72
    # Gross income standard = 791.72 * 1.85 = 1_464.68
    mt_tanf_gross_income_standard: 1_464.68
    mt_tanf_countable_income: 0
    mt_tanf_payment_standard_eligible: true
    mt_tanf_benefit_standard_eligible: true
    mt_tanf_gmi_eligible: true
    mt_tanf_income_eligible: true
    mt_tanf_resources_eligible: true
    mt_tanf_meets_work_requirements: true
    mt_tanf_eligible: true
    # TANF = max(725.08 - 0, 0) = 725.08
    mt_tanf: 725.08

- name: Case 11, FPL pinning stability - 2026 produces same standards as 2024.
  period: 2026-01
  absolute_error_margin: 0.1
  input:
    people:
      person1:
        age: 40
        weekly_hours_worked: 35
        is_tax_unit_head_or_spouse: true
        immigration_status: CITIZEN
      person2:
        age: 10
        is_tax_unit_dependent: true
    spm_units:
      spm_unit:
        members: [person1, person2]
    households:
      household:
        members: [person1, person2]
        state_code: MT
  output:
    mt_tanf_assistance_unit_size: 2
    # FPL pinned to 2023: (14_580 + 5_140) / 12 = 1_643.33
    # Payment standard = 1_643.33 * 0.35 = 575.17
    mt_tanf_payment_standard: 575.17
    # Benefit standard = 1_643.33 * 0.30 = 493.00
    mt_tanf_benefit_standard: 493.00
    mt_tanf_countable_income: 0
    mt_tanf_payment_standard_eligible: true
    mt_tanf_benefit_standard_eligible: true
    mt_tanf_gmi_eligible: true
    mt_tanf_income_eligible: true
    mt_tanf_resources_eligible: true
    mt_tanf_meets_work_requirements: true
    mt_tanf_eligible: true
    # TANF = 575.17
    mt_tanf: 575.17
